# ADR 001: ã‚»ã‚­ãƒ¥ã‚¢ãªèªè¨¼ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…ï¼ˆHttpOnly Cookie + ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ï¼‰

## ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
**æ‰¿èªæ¸ˆã¿** - 2026-02-02

## ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

### ç¾åœ¨ã®å•é¡Œ
ç¾åœ¨ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€Google OAuth 2.0ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’**sessionStorage**ã«ä¿å­˜ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã¯ã„ãã¤ã‹ã®å•é¡ŒãŒã‚ã‚Šã¾ã™ï¼š

1. **ã‚»ãƒƒã‚·ãƒ§ãƒ³æŒç¶šæ€§ã®å•é¡Œ**
   - ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã‚‹ã¨ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã•ã‚Œã‚‹
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ãŒæ‚ªã„

2. **ãƒˆãƒ¼ã‚¯ãƒ³æœ‰åŠ¹æœŸé™ã®å•é¡Œ**
   - Googleã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã¯**1æ™‚é–“**ã§æœŸé™åˆ‡ã‚Œ
   - é »ç¹ãªå†ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦

3. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®æ‡¸å¿µ**
   - sessionStorage/localStorageã¯**XSSæ”»æ’ƒ**ã«å¯¾ã—ã¦è„†å¼±
   - JavaScriptã‹ã‚‰ç°¡å˜ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹
   - ãƒˆãƒ¼ã‚¯ãƒ³ãŒç›—ã¾ã‚Œã‚‹ãƒªã‚¹ã‚¯

### ç¾åœ¨ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚ Google API  â”‚
â”‚   (React)   â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   OAuth2    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â†“
sessionStorage
(ãƒˆãƒ¼ã‚¯ãƒ³ãŒJSã‹ã‚‰ä¸¸è¦‹ãˆ)
```

### æ¤œè¨Žã—ãŸé¸æŠžè‚¢

#### é¸æŠžè‚¢1: localStorage ã«å¤‰æ›´
- **ãƒ¡ãƒªãƒƒãƒˆ**: ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã¦ã‚‚ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶­æŒ
- **ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**: ãƒˆãƒ¼ã‚¯ãƒ³ã¯1æ™‚é–“ã§æœŸé™åˆ‡ã‚Œã€XSSè„†å¼±æ€§ã¯å¤‰ã‚ã‚‰ãš
- **è©•ä¾¡**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é¢ã§ä¸ååˆ†

#### é¸æŠžè‚¢2: ãƒˆãƒ¼ã‚¯ãƒ³ç›£è¦– + è‡ªå‹•å†èªè¨¼
- **ãƒ¡ãƒªãƒƒãƒˆ**: æœŸé™åˆ‡ã‚Œå‰ã«è‡ªå‹•å†èªè¨¼
- **ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸åœ¨æ™‚ã¯å†èªè¨¼ä¸å¯ã€å®Ÿè£…ãŒè¤‡é›‘
- **è©•ä¾¡**: ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ãªã—ã§ã¯é™ç•ŒãŒã‚ã‚‹

#### é¸æŠžè‚¢3: **HttpOnly Cookie + ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼**ï¼ˆæŽ¡ç”¨ï¼‰
- **ãƒ¡ãƒªãƒƒãƒˆ**:
  - ãƒˆãƒ¼ã‚¯ãƒ³ãŒJavaScriptã‹ã‚‰å®Œå…¨ã«éš è”½ã•ã‚Œã‚‹
  - ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã§é•·æœŸé–“ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶­æŒ
  - XSSæ”»æ’ƒã‹ã‚‰ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿è­·
  - æ¥­ç•Œæ¨™æº–ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
- **ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**:
  - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ãŒå¿…è¦
  - å®Ÿè£…ã‚³ã‚¹ãƒˆãŒé«˜ã„
  - ã‚¤ãƒ³ãƒ•ãƒ©ç®¡ç†ãŒå¿…è¦
- **è©•ä¾¡**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨åˆ©ä¾¿æ€§ã®ãƒ™ã‚¹ãƒˆãƒãƒ©ãƒ³ã‚¹

## æ±ºå®š

### æŽ¡ç”¨ã™ã‚‹æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

**ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Node.js + Express + TypeScript
- **ç†ç”±**:
  - Reactï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰ã¨ã®ã‚³ãƒ¼ãƒ‰å…±æœ‰ãŒå¯èƒ½
  - JavaScriptã§çµ±ä¸€ã§ãã‚‹
  - ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ãŒè±Šå¯Œ
  - Vercelã§ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ä¸€ç·’ã«ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½

**èªè¨¼æ–¹å¼**: OAuth 2.0 ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ•ãƒ­ãƒ¼ + ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³
- Authorization Codeãƒ•ãƒ­ãƒ¼ã‚’ä½¿ç”¨
- ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã¨ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã‚µãƒ¼ãƒãƒ¼å´ã§ç®¡ç†
- HttpOnly Cookieã§ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ **: server/ãƒ•ã‚©ãƒ«ãƒ€ã‚’è¿½åŠ 
```
music-player-from-drive/
â”œâ”€â”€ src/                # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆReact + Viteï¼‰
â”œâ”€â”€ server/             # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆExpress + TypeScriptï¼‰
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ routes/     # APIãƒ«ãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ middleware/ # èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”‚   â”‚   â”œâ”€â”€ utils/      # ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
â”‚   â”‚   â””â”€â”€ types/      # TypeScriptåž‹å®šç¾©
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”œâ”€â”€ package.json        # ãƒ«ãƒ¼ãƒˆã®package.json
â””â”€â”€ docs/adr/           # ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ±ºå®šè¨˜éŒ²
```

### æ–°ã—ã„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend   â”‚ â”€â”€â”€> â”‚   Backend    â”‚ â”€â”€â”€> â”‚ Google API  â”‚
â”‚   (React)   â”‚ <â”€â”€â”€ â”‚   (Express)  â”‚ <â”€â”€â”€ â”‚   OAuth2    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“                      â†“
HttpOnly Cookie      ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³
(JSã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯)   + ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³
                      (ã‚µãƒ¼ãƒãƒ¼ã§å®‰å…¨ã«ä¿ç®¡)
```

### å®Ÿè£…ã™ã‚‹æ©Ÿèƒ½

1. **OAuth 2.0 ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ•ãƒ­ãƒ¼**
   - `/auth/google` - Googleèªè¨¼é–‹å§‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
   - `/auth/google/callback` - Googleèªè¨¼ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
   - Authorization Codeã‚’ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã¨ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã«äº¤æ›

2. **ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†**
   - ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ãƒ¡ãƒ¢ãƒªã¾ãŸã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜
   - ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³æœŸé™åˆ‡ã‚Œæ™‚ã«è‡ªå‹•æ›´æ–°
   - ã‚»ãƒƒã‚·ãƒ§ãƒ³æœ‰åŠ¹æœŸé™: 7æ—¥é–“ï¼ˆè¨­å®šå¯èƒ½ï¼‰

3. **HttpOnly Cookieè¨­å®š**
   - `httpOnly: true` - JavaScriptã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯
   - `secure: true` - HTTPSé€šä¿¡ã®ã¿ï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰
   - `sameSite: 'lax'` - CSRFå¯¾ç­–
   - Cookieå: `session_id`

4. **CORSè¨­å®š**
   - é–‹ç™ºç’°å¢ƒ: `http://localhost:5173` (Viteãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ)
   - æœ¬ç•ªç’°å¢ƒ: ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆã®ãƒ‰ãƒ¡ã‚¤ãƒ³
   - `credentials: true` - Cookieé€ä¿¡ã‚’è¨±å¯

5. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼**
   - Helmet.jsã‚’ä½¿ç”¨
   - CSPï¼ˆContent Security Policyï¼‰
   - XSSå¯¾ç­–

## çµæžœ

### è‰¯ã„ç‚¹

âœ… **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å¤§å¹…ãªå‘ä¸Š**
- ãƒˆãƒ¼ã‚¯ãƒ³ãŒJavaScriptã‹ã‚‰å®Œå…¨ã«éš è”½
- XSSæ”»æ’ƒã‹ã‚‰ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿è­·
- æ¥­ç•Œæ¨™æº–ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«æº–æ‹ 

âœ… **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®æ”¹å–„**
- ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã¦ã‚‚ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶­æŒï¼ˆ7æ—¥é–“ï¼‰
- è‡ªå‹•ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã§ä¸­æ–­ãªã—
- é »ç¹ãªå†ãƒ­ã‚°ã‚¤ãƒ³ãŒä¸è¦

âœ… **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¿½åŠ ã§ãƒžãƒ«ãƒã‚µãƒ¼ãƒãƒ¼å¯¾å¿œå¯èƒ½
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã®æŸ”è»Ÿæ€§
- å°†æ¥çš„ãªæ©Ÿèƒ½æ‹¡å¼µãŒã—ã‚„ã™ã„

âœ… **ä¿å®ˆæ€§**
- TypeScriptã§åž‹å®‰å…¨
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã‚’çµ±ä¸€
- ãƒ†ã‚¹ãƒˆãŒæ›¸ãã‚„ã™ã„

### æ‚ªã„ç‚¹ï¼ˆãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ï¼‰

âŒ **å®Ÿè£…ã‚³ã‚¹ãƒˆã®å¢—åŠ **
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã®æ§‹ç¯‰ãŒå¿…è¦
- OAuth 2.0ãƒ•ãƒ­ãƒ¼ã®å®Ÿè£…ãŒè¤‡é›‘
- ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®å¢—åŠ 

âŒ **ã‚¤ãƒ³ãƒ•ãƒ©ç®¡ç†ã®è¤‡é›‘åŒ–**
- ã‚µãƒ¼ãƒãƒ¼ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãŒå¿…è¦
- ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†ãŒå¢—ãˆã‚‹
- ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã¨ãƒ­ã‚°ç®¡ç†ãŒå¿…è¦

âŒ **é–‹ç™ºé€Ÿåº¦ã¸ã®å½±éŸ¿**
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ä¸¡æ–¹ã‚’é–‹ç™º
- APIã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãŒå¿…è¦
- CORSè¨­å®šã®ãƒ‡ãƒãƒƒã‚°ãŒå¿…è¦ã«ãªã‚‹å ´åˆãŒã‚ã‚‹

## å®Ÿè£…è¨ˆç”»

### Phase 1: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®åŸºæœ¬æ§‹é€ ï¼ˆå®Œäº† âœ…ï¼‰
- [x] server/ãƒ•ã‚©ãƒ«ãƒ€ã¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ä½œæˆ
- [x] package.jsonã¨tsconfig.jsonã®è¨­å®š
- [x] ADRã®ä½œæˆ

### Phase 2: Expressã‚µãƒ¼ãƒãƒ¼ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆå®Œäº† âœ… 2026-02-02ï¼‰
- [x] index.tsã®å®Ÿè£…
- [x] åŸºæœ¬çš„ãªãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®è¨­å®šï¼ˆCORS, Helmet, Cookie Parserï¼‰
- [x] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- [x] Helmetã«ã‚ˆã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š
- [x] CORSè¨­å®šï¼ˆlocalhost:5173, 5174å¯¾å¿œï¼‰
- [x] dotenv/configã«ã‚ˆã‚‹ç’°å¢ƒå¤‰æ•°èª­ã¿è¾¼ã¿

### Phase 3: OAuth 2.0ã®å®Ÿè£…ï¼ˆå®Œäº† âœ… 2026-02-02ï¼‰
- [x] Google OAuth 2.0ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è¨­å®š
- [x] èªè¨¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å®Ÿè£…ï¼ˆ/auth/googleï¼‰
- [x] ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã®å®Ÿè£…ï¼ˆ/auth/google/callbackï¼‰
- [x] ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—ã¨ä¿å­˜
- [x] ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã®å–å¾—ï¼ˆoffline accessï¼‰
- [x] ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ç¢ºèªã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆ/auth/statusï¼‰
- [x] ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆ/auth/tokenï¼‰
- [x] ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆ/auth/logoutï¼‰

### Phase 4: ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ï¼ˆå®Œäº† âœ… 2026-02-02ï¼‰
- [x] ãƒˆãƒ¼ã‚¯ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®å®Ÿè£…ï¼ˆã‚¤ãƒ³ãƒ¡ãƒ¢ãƒª - tokenManagerï¼‰
- [x] ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆæœŸé™åˆ‡ã‚Œ5åˆ†å‰ã«è‡ªå‹•æ›´æ–°ï¼‰
- [x] ã‚»ãƒƒã‚·ãƒ§ãƒ³æœ‰åŠ¹æœŸé™ã®ç®¡ç†
- [x] æœŸé™åˆ‡ã‚Œã‚»ãƒƒã‚·ãƒ§ãƒ³ã®è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆ1æ™‚é–“ã”ã¨ï¼‰
- [x] Graceful shutdownã®å®Ÿè£…

### Phase 5: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ä¿®æ­£ï¼ˆéƒ¨åˆ†å®Œäº† ðŸ”„ï¼‰
- [x] sessionStorageå‰Šé™¤ï¼ˆæ—¢å­˜å®Ÿè£…ç¶­æŒï¼‰
- [x] ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã¨ã®é€£æºï¼ˆ/auth/statusã¨/auth/tokenï¼‰
- [x] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ”¹å–„
- [ ] å®Œå…¨ãªãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰çµ±åˆï¼ˆæ—¢å­˜ã®Google APIç›´æŽ¥å‘¼ã³å‡ºã—ã‚’ç¶­æŒï¼‰

### Phase 6: ãƒ†ã‚¹ãƒˆã¨ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆé€²è¡Œä¸­ ðŸ”„ï¼‰
- [x] é–‹ç™ºç’°å¢ƒã§ã®ãƒ†ã‚¹ãƒˆ
- [x] Google Cloud Consoleã®è¨­å®šå¤‰æ›´ï¼ˆãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURIè¿½åŠ ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆå–å¾—ï¼‰
- [x] ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã®å®Ÿè£…ï¼ˆVitest + supertestï¼‰
  - [x] TokenManagerã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼ˆ11ãƒ†ã‚¹ãƒˆï¼‰
  - [x] èªè¨¼ãƒ«ãƒ¼ãƒˆã®çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆ12ãƒ†ã‚¹ãƒˆï¼‰
  - [x] ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆè¨­å®š
- [x] ESLint 9ã¸ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ï¼ˆTypeScript ESLint v8å¯¾å¿œï¼‰
- [x] ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®å‹•ä½œç¢ºèªï¼ˆGoogleãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸï¼‰
- [ ] æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆVercelï¼‰
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»

## è¿½åŠ ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–

### çŸ­æœŸï¼ˆå®Ÿè£…æ™‚ï¼‰
- CSRF ãƒˆãƒ¼ã‚¯ãƒ³ã®å®Ÿè£…
- Rate Limitingã®è¿½åŠ 
- ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œå›žæ•°ã®åˆ¶é™

### ä¸­æœŸï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤å¾Œï¼‰
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ç›£è¦–ã¨ãƒ­ã‚°è¨˜éŒ²
- ä¸å¯©ãªã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¤œå‡º
- ãƒˆãƒ¼ã‚¯ãƒ³å¤±åŠ¹ãƒ¡ã‚«ãƒ‹ã‚ºãƒ 

### é•·æœŸï¼ˆå°†æ¥ï¼‰
- 2è¦ç´ èªè¨¼ï¼ˆ2FAï¼‰ã®è¿½åŠ 
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã®å®šæœŸå®Ÿæ–½
- ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ

## å‚è€ƒè³‡æ–™

- [OAuth 2.0 RFC 6749](https://datatracker.ietf.org/doc/html/rfc6749)
- [Google OAuth 2.0 Documentation](https://developers.google.com/identity/protocols/oauth2)
- [OWASP Authentication Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html)
- [HttpOnly Cookie Best Practices](https://owasp.org/www-community/HttpOnly)

## å¤‰æ›´å±¥æ­´

- 2026-02-03: Phase 2-4å®Œäº†ã€ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆè¿½åŠ ã€ESLint 9ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã€ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®å‹•ä½œç¢ºèªå®Œäº†
  - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã®å®Œå…¨å®Ÿè£…ï¼ˆExpress + TypeScriptï¼‰
  - OAuth 2.0ãƒ•ãƒ­ãƒ¼å®Ÿè£…ï¼ˆãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³å¯¾å¿œï¼‰
  - ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ã®å®Ÿè£…
  - Vitest + supertestã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆï¼ˆ23ãƒ†ã‚¹ãƒˆã€å…¨ã¦æˆåŠŸï¼‰
  - ESLint 9 + TypeScript ESLint v8ã¸ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰
  - Google Cloud Consoleã®è¨­å®šå®Œäº†
  - ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®Googleãƒ­ã‚°ã‚¤ãƒ³å‹•ä½œç¢ºèªæˆåŠŸ
- 2026-02-02: åˆç‰ˆä½œæˆã€HttpOnly Cookie + ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã®æŽ¡ç”¨ã‚’æ±ºå®š
